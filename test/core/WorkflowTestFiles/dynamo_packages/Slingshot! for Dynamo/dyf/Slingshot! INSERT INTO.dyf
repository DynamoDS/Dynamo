<Workspace Version="0.6.2.29585" X="-108.392302142302" Y="175.533189033189" zoom="1" Description="SQL INSERT INTO VALUES command." Category="Core.Lists.Query" Name="Slingshot! INSERT INTO" ID="8ebcfba0-78d6-4141-9b6b-d42b101f78ce">
  <Elements>
    <Dynamo.Nodes.Python type="Dynamo.Nodes.Python" guid="a12f34ad-28f5-44cd-88f4-5d7767df95cf" nickname="Python Script" x="469.321428571429" y="0" isVisible="true" isUpstreamVisible="true" lacing="Disabled">
      <Script># Default imports
import clr
clr.AddReference('RevitAPI')
clr.AddReference('RevitAPIUI')
from Autodesk.Revit.DB import *
import Autodesk
import sys
import clr
path = r'C:\Autodesk\Dynamo\Core'
exec_path = r'C:\Autodesk\Dynamo\Core\dll'
sys.path.append(path)
sys.path.append(exec_path)
clr.AddReference('LibGNet')
from Autodesk.LibG import *

#The input to this node will be stored in the IN variable.
_table = IN[0]
_columns = IN[1]
_values = IN[2]

#columns string
if hasattr(_columns, "__iter__"):
	colstr = _columns[0]
	for i in range(0,len(_columns)-1):
		colstr = colstr + "," + _columns[i+1]
else:
	colstr = _columns

#flip values matrix and create string list

_valstrings = []
if hasattr(_values, "__iter__"):
	testvals = _values[0]
	if hasattr(testvals, "__iter__"):
		_flipvalues = []
		for i in range(0,len(_values[0])):
			vals = []
			for j in range(0,len(_values)):
				val = _values[j]
				vals.append(val[i])
			_flipvalues.append(vals)
		
		for i in range(0,len(_flipvalues)):
			vals = _flipvalues[i]
			valstr = "'" + vals[0] + "'"
			for j in range(0,len(vals)-1):
				valstr = valstr + ",'" + vals[j+1] + "'"
			_valstrings.append(valstr)
	else:
		for i in range(0,len(_values)):
			valstr = "'" + _values[i] + "'"
			_valstrings.append(valstr)
else:
	_valstrings = _values
	
#SQL
sql = []
if hasattr(_valstrings, "__iter__"):
	for i in range(0,len(_valstrings)):
		sqlstr = 'INSERT INTO ' + _table + '(' + colstr + ') VALUES (' + _valstrings[i] + ");"
		sql.append(sqlstr)
else:
	sql = 'INSERT INTO ' + _table + '(' + colstr + ') VALUES (' + _valstrings + ");"

#Assign your output to the OUT variable
OUT = sql</Script>
    </Dynamo.Nodes.Python>
    <Dynamo.Nodes.NewList type="Dynamo.Nodes.NewList" guid="41fe0436-0692-4d2d-bbdf-466b66e8e8c3" nickname="List" x="250" y="0.249999999999829" isVisible="true" isUpstreamVisible="true" lacing="Disabled">
      <Input name="index0" />
      <Input name="index1" />
      <Input name="index2" />
    </Dynamo.Nodes.NewList>
    <Dynamo.Nodes.Symbol type="Dynamo.Nodes.Symbol" guid="7d624981-a8b0-4997-b20a-05460c474c1d" nickname="Input" x="0" y="0" isVisible="true" isUpstreamVisible="true" lacing="Disabled">
      <Symbol value="Table" />
    </Dynamo.Nodes.Symbol>
    <Dynamo.Nodes.Symbol type="Dynamo.Nodes.Symbol" guid="eae67cdb-6c6b-478a-84dd-7239adab3956" nickname="Input" x="0" y="150" isVisible="true" isUpstreamVisible="true" lacing="Disabled">
      <Symbol value="Columns" />
    </Dynamo.Nodes.Symbol>
    <Dynamo.Nodes.Symbol type="Dynamo.Nodes.Symbol" guid="75402c62-7ec8-4f19-ae8a-c2c3712a374b" nickname="Input" x="0" y="300" isVisible="true" isUpstreamVisible="true" lacing="Disabled">
      <Symbol value="Values" />
    </Dynamo.Nodes.Symbol>
    <Dynamo.Nodes.Output type="Dynamo.Nodes.Output" guid="f57eca04-f297-4c01-b03e-138ef3976f48" nickname="Output" x="650.321428571429" y="0" isVisible="true" isUpstreamVisible="true" lacing="Disabled">
      <Symbol value="SQL" />
    </Dynamo.Nodes.Output>
    <Dynamo.Nodes.Watch type="Dynamo.Nodes.Watch" guid="2752c0a5-9815-427e-be32-deefc242f692" nickname="Watch" x="608.892302142302" y="173.966810966811" isVisible="true" isUpstreamVisible="true" lacing="Disabled" />
  </Elements>
  <Connectors>
    <Dynamo.Models.ConnectorModel start="a12f34ad-28f5-44cd-88f4-5d7767df95cf" start_index="0" end="f57eca04-f297-4c01-b03e-138ef3976f48" end_index="0" portType="0" />
    <Dynamo.Models.ConnectorModel start="a12f34ad-28f5-44cd-88f4-5d7767df95cf" start_index="0" end="2752c0a5-9815-427e-be32-deefc242f692" end_index="0" portType="0" />
    <Dynamo.Models.ConnectorModel start="41fe0436-0692-4d2d-bbdf-466b66e8e8c3" start_index="0" end="a12f34ad-28f5-44cd-88f4-5d7767df95cf" end_index="0" portType="0" />
    <Dynamo.Models.ConnectorModel start="7d624981-a8b0-4997-b20a-05460c474c1d" start_index="0" end="41fe0436-0692-4d2d-bbdf-466b66e8e8c3" end_index="0" portType="0" />
    <Dynamo.Models.ConnectorModel start="eae67cdb-6c6b-478a-84dd-7239adab3956" start_index="0" end="41fe0436-0692-4d2d-bbdf-466b66e8e8c3" end_index="1" portType="0" />
    <Dynamo.Models.ConnectorModel start="75402c62-7ec8-4f19-ae8a-c2c3712a374b" start_index="0" end="41fe0436-0692-4d2d-bbdf-466b66e8e8c3" end_index="2" portType="0" />
  </Connectors>
  <Notes />
</Workspace>