<!--
    There are two versions of this HTML file. One that is part of the Dynamo Dictionary
    codebase and one that is part of the Dynamo codebase, used for displaying additional
    error information in the Dynamo side panel.

    These files need to kept in sync manually: if making edits to one version of the file,
    make sure to update the other version as well.

    Dynamo: https://github.com/DynamoDS/Dynamo
    Dynamo Dictionary: https://github.com/DynamoDS/DynamoDictionary_React
-->

<!-- These headers are required to force the browser embedded in the DocumentationBrowser extension to render in modern IE11 mode. -->

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width initial-scale=1">
    <meta charset="UTF-8" />
</head>

<style>
    body {
        color: white;
        font-size: 14px;
        font-family: "Artifakt Element";
        src: url("fonts/ArtifaktElement-Regular.woff") format("woff");
        padding: 1%;
    }

    a {
        color: lightgray;
        cursor: pointer;
        background-color: transparent;
    }

    table {
        border-collapse: collapse;
        border: 1px solid white;
    }

    th,
    td {
        border: 1px solid white;
        padding-right: 10px;
        padding-left: 10px;
        padding-bottom: 10px;
        padding-top: 10px;
    }

    samp {
      margin-top: 10px;
      display: block;
      color: lightgrey;
    }

    code .k {
      color: #dcdcaa;
      font-weight: bold;
    }

    code .s {
      color: #ce9178;
    }

    code .v {
      color: #b5cea8;
    }

    code .o {
      color: #c586c0;
      font-weight: bold;
    }

    code .i {
      color: #569cd6;
      font-weight: bold;
    }

    code .b {
      color: #9cdcfe;
      font-weight: bold;
    }

    code .e {
      color: #43c9b0;
    }

    code > .nl .nl {
      padding-left: 10px;
    }

    code .nl {
      display: block;
    }

    thead {
      text-align: center;
    }

    .hidden-lg {
      display: none;
    }

    @media screen and (max-width: 600px) {
      table {
        width: 100%;
      }

      table, th, td {
        border: none;
      }

      tr {
        border: 1px solid white;
        display: block;
      }

      td, th {
        display: block;
      }

      .hidden-lg {
        display: block;
        font-weight: bold;
        text-align: center;
        border-bottom: 1px solid white;
      }

      .hidden-sm {
        display: none;
      }

      .spaced-sm {
        margin-top: 20px;
      }

      tbody tr:first-of-type {
        border-bottom: none;
      }
    }
</style>

<!-- Use inline styles to keep Dynamo Dictionary styling in the dictionary -->
<!-- and custom styling in Dynamo sidepanel. -->

<body style="background-color: #353535; font-family: 'Artifakt Element', 'Open Sans';">

    <h2>Updating your IronPython2 script to use CPython3</h2>
    <p>
        As of January 1st, 2020 IronPython2  is no longer supported by the Python community and while work is being done on Ironpython3, it is not yet ready for use. 
        We are upgrading the Python Node in Dynamo to use the CPython3 engine (Python 3) instead of IronPython2 (Python 2) to allow access to popular modern libraries and alleviate security concerns 
        now that all maintenance work on IronPython2 has ceased. Upgrading IronPython2 to CPython3 will allow us to stay up to date with the latest Python features, security fixes and changes.
    </p>

    <h3>What does it mean for you?</h4>
        <p>
            Python 3 and Python 2 aren't different languages, Python 3 is a new and enhanced version of Python 2.
            However Python 3 isn't necessarily backwards compatible with Python 2 code. So what do you need to do as a
            Dynamo Python script developer, in most cases nothing, in the rare occasions where you do run into
            incompatible syntax you will need to upgrade these parts of your script to Python 3 syntax.
        </p>
        <p>
            Typically, Python scripts will be able to run with either the IronPython2 or CPython3 engine selected. 
            For the cases where your script contains syntax that has changed between versions, we have made it easier for you to update your script. 
            If you are curious about diving deeper into the differences between the two Python versions, here are two external links to get you started:
            <ul>
                <li>
                    <a href="https://docs.python.org/3/howto/pyporting.html">
                        The official "Porting Python 2 Code to Python
                        3"
                        guide
                    </a>
                </li>
                <li>
                    <a href="http://python3porting.com/">Supporting Python 3: An in-depth guide" guide</a>
                </li>
            </ul>
        </p>

        <p>
            If you on the other hand prefer things to just work without having to dig too much into the specifics,
            we have included a automatic code converter in the Python node. With this, all you need to do is
            switch to the CPython3 engine and Dynamo will give you a window that shows you which changes are needed
            and give you the option to decline or accept the conversion.
        </p>

        <h3>Key syntax changes in Python 3</h4>
            <p>
                We have put together a small list of some of the key syntax changes between Python 2 and Python 3,
                things
                is by no means a full list but a section of some the most used features that has changed syntax.
            </p>


            <h4><b>The Print Function</b></h4>
            <p>
                The print-syntax is probably the most widely known change, and even though it isn't really used
                in Dynamo we include a sample of how the <code>print</code> statement has changed.
            </p>

            <table>
                <tr>
                    <th>Python 2</th>
                    <th class="hidden-sm">Python 3</th>
                </tr>
                <tr>
                    <td>
                        <code><span class="k">print</span> <span class="s">'Hello, Dynamo!'</span></code>
                        <samp>// Hello, Dynamo!</samp>
                    </td>
                    <th class="hidden-lg" style="border-top: 1px solid white;">Python 3</th>
                    <td>
                        <code><span class="k">print</span>(<span class="s">'Hello, Dynamo!'</span>)</code>
                        <samp>// Hello, Dynamo!</samp>
                    </td>
                </tr>
            </table>

            <h4><b>Integer division</b></h4>
            <p>
                This change will not raise any exceptions in your script, but it might affect the output.
                The default division operator behavior in Python 2.x when presented with integer operands is
                to use classic division which truncates the decimal place and returns an integer.
                When given a pair of floating-point operands, it returns the actual floating-point quotient (aka true
                division).
            </p>

            <table>
                <tr>
                    <th>Python 2</th>
                    <th class="hidden-sm">Python 3</th>
                </tr>
                <tr>
                    <td>
                        <code><span class="v">1</span>/<span class="v">2</span></code>
                        <samp>// 0</samp>
                    </td>
                    <td class="hidden-lg" style="border-top: 1px solid white;">Python 3</td>
                    <td>
                        <code><span class="v">1</span>/<span class="v">2</span></code>
                        <samp>// 0.5</samp>
                    </td>
                </tr>
                <tr class="spaced-sm">
                    <td class="hidden-lg">Python 2</td>
                    <td>
                        <code><span class="v">1.0</span>/<span class="v">2.0</span></code>
                        <samp>// 0.5</samp>
                    </td>
                    <td class="hidden-lg" style="border-top: 1px solid white;">Python 3</td>
                    <td>
                        <code><span class="v">1.0</span>/<span class="v">2.0</span></code>
                        <samp>// 0.5</samp>
                    </td>
                </tr>
            </table>

            <h4><b>xrange</b></h4>
            <p>
                <code>xrange</code> is usually used in combination with a for-loop or list-comprehensive statements.
                It is generally faster to iterate over <code>xrange()</code> compared to <code>range()</code> when you
                only need to iterate once.
                In Python 3, the <code>range()</code> was implemented like the <code>xrange()</code> function so that a
                dedicated xrange() function does not exist anymore
                (<code>xrange()</code> raises a NameError in Python 3).
            </p>

            <table>
                <tr>
                    <th>Python 2</th>
                    <th class="hidden-sm">Python 3</th>
                </tr>
                <tr>
                    <td>
                        <code>
                            <span class="nl">n = <span class="v">1000000</span></span>
                            <span class="nl">
                              <span class="o">for</span> i <span class="i">in</span> <span class="b">xrange</span>(n):
                                <span class="nl"><span class="k">print</span> i</span>
                            </span>
                        </code>
                        <samp>// 1,2,3,4,5...</samp>
                    </td>
                    <th class="hidden-lg" style="border-top: 1px solid white;">Python 3</th>
                    <td>
                        <code>
                          <span class="nl">n = <span class="v">1000000</span></span>
                          <span class="nl">
                            <span class="o">for</span> i <span class="i">in</span> <span class="k">range</span>(n):
                              <span class="nl"><span class="k">print</span>(i)</span>
                            </span>
                        </code>
                        <samp>// 1,2,3,4,5...</samp>
                    </td>
                </tr>
            </table>

            <h4><b>Raising and handling exceptions</b></h4>
            <p>
                Where Python 2 accepts both notations, the ‘old’ and the ‘new’ syntax, Python 3 raises a SyntaxError
                if we don’t enclose the exception argument in parentheses. Also the handling of exceptions has slightly
                changed in Python 3.
                In Python 3 we have to use the “as” keyword.
            </p>

            <table>
                <tr>
                    <th>Python 2</th>
                    <th class="hidden-sm">Python 3</th>
                </tr>
                <tr>
                    <td>
                        <code>
                          <span class="o">raise</span> <span class="e">IOError</span>, <span class="s">"file error"</span>
                        </code>
                        <samp>// IOError: file error</samp>
                    </td>
                    <td class="hidden-lg" style="border-top: 1px solid white;">Python 3</td>
                    <td>
                        <code>
                          <span class="o">raise</span> <span class="e">IOError</span>(<span class="s">"file error"</span>)
                        </code>
                        <samp>// OSError: file error</samp>
                    </td>
                </tr>
                <tr class="spaced-sm">
                    <td class="hidden-lg">Python 2</td>
                    <td>
                        <code>
                          <span class="nl">
                            <span class="o">try:</span>
                              <span class="nl">let_us_cause_a_NameError</span>
                          </span>
                          <span class="nl">
                            <span class="o">except</span> <span class="e">NameError</span>, err:
                              <span class="nl"><span class="k">print</span> err, <span class="s">'--> our error message'</span></span>
                          </span>
                      </code>
                      <samp>// IOError: file error</samp>
                    </td>
                    <td class="hidden-lg" style="border-top: 1px solid white;">Python 3</td>
                    <td>
                        <code>
                          <span class="nl">
                            <span class="o">try:</span>
                              <span class="nl">let_us_cause_a_NameError</span>
                          </span>
                          <span class="nl">
                            <span class="o">except</span> <span class="e">NameError</span> <span class="o">as</span> err:
                              <span class="nl"><span class="k">print</span>(err, <span class="s">'--> our error message'</span>)</span>
                          </span>
                        </code>
                        <samp>// OSError: file error</samp>
                    </td>
                </tr>
            </table>
</body>