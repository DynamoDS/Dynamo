<UserControl x:Class="Dynamo.Wpf.Controls.RunSettingsControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"  
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:ui="clr-namespace:Dynamo.UI"
             xmlns:models="clr-namespace:Dynamo.Models;assembly=DynamoCore"
             xmlns:sys="clr-namespace:System;assembly=mscorlib"
             xmlns:viewModels="clr-namespace:Dynamo.Wpf.ViewModels"
             xmlns:p="clr-namespace:Dynamo.Wpf.Properties"
             xmlns:heid="http://schemas.heidesoft.com/components"             
             xmlns:controls="clr-namespace:Dynamo.Wpf.Controls"
             mc:Ignorable="d" 
             d:DesignHeight="40" Width="400.8">

    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ui:SharedResourceDictionary Source="{x:Static ui:SharedDictionaryManager.DynamoModernDictionaryUri}" />
                <ui:SharedResourceDictionary Source="{x:Static ui:SharedDictionaryManager.DynamoConvertersDictionaryUri}" />
                <ui:SharedResourceDictionary Source="{x:Static ui:SharedDictionaryManager.DynamoColorsAndBrushesDictionaryUri}" />
                <ui:SharedResourceDictionary Source="{x:Static ui:SharedDictionaryManager.MenuStyleDictionaryUri}" />
            </ResourceDictionary.MergedDictionaries>

            <ObjectDataProvider MethodName="GetValues"
                        ObjectType="{x:Type sys:Enum}"
                        x:Key="RunTypes">
                <ObjectDataProvider.MethodParameters>
                    <x:Type TypeName="models:RunType" />
                </ObjectDataProvider.MethodParameters>
            </ObjectDataProvider>

            <viewModels:RunPeriodConverter x:Key="RunPeriodConverter"/>

            <Style x:Key="busyStyle" TargetType="{x:Type Control}">
                <Setter Property="Width" Value="100" />
                <Setter Property="Height" Value="100" />
                <Setter Property="HorizontalAlignment" Value="Center" />
                <Setter Property="VerticalAlignment" Value="Center" />
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="{x:Type Control}">
                            <ControlTemplate.Resources>
                                <Storyboard x:Name="spinner" x:Key="spinner" RepeatBehavior="Forever">
                                    <DoubleAnimationUsingKeyFrames BeginTime="00:00:00" Storyboard.TargetName="canvas" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[2].(RotateTransform.Angle)">
                                        <EasingDoubleKeyFrame KeyTime="00:00:00" Value="0"/>
                                        <EasingDoubleKeyFrame KeyTime="00:00:00.5000000" Value="180"/>
                                        <EasingDoubleKeyFrame KeyTime="00:00:01" Value="359"/>
                                    </DoubleAnimationUsingKeyFrames>

                                </Storyboard>
                            </ControlTemplate.Resources>

                            <Canvas>
                                <Canvas x:Name="canvas"  Height="24" Width="24" RenderTransformOrigin="0.5,0.5">
                                    <Canvas.RenderTransform>
                                        <TransformGroup>
                                            <ScaleTransform/>
                                            <SkewTransform/>
                                            <RotateTransform/>
                                            <TranslateTransform/>
                                        </TransformGroup>
                                    </Canvas.RenderTransform>

                                    <Path Data="F1 M 10.000,2.918 C 6.123,2.918 2.964,6.050 2.920,9.917 L 0.002,9.917 C 0.046,4.441 4.514,0.000 10.000,0.000 C 15.487,0.000 19.954,4.441 19.999,9.917 L 17.080,9.917 C 17.036,6.050 13.878,2.918 10.000,2.918 Z" UseLayoutRounding="False" Canvas.Top="1.932" Canvas.Left="1.937">
                                        <Path.Fill>
                                            <LinearGradientBrush MappingMode="Absolute" StartPoint="399.906,240.414" EndPoint="419.903,240.414">
                                                <LinearGradientBrush.GradientStops>
                                                    <GradientStop Offset="0.26" Color="#ff7f7f7f"/>
                                                    <GradientStop Offset="1.00" Color="#ff323232"/>
                                                </LinearGradientBrush.GradientStops>
                                                <LinearGradientBrush.Transform>
                                                    <MatrixTransform Matrix="-1.000,0.000,0.000,-1.000,419.905,245.373" />
                                                </LinearGradientBrush.Transform>
                                            </LinearGradientBrush>
                                        </Path.Fill>
                                    </Path>
                                    <Path Data="F1 M 17.080,9.917 C 17.080,9.945 17.083,9.972 17.083,10.000 C 17.083,13.904 13.905,17.082 10.000,17.082 C 6.095,17.082 2.917,13.904 2.917,10.000 C 2.917,9.972 2.920,9.945 2.920,9.917 L 0.002,9.917 C 0.002,9.945 0.000,9.972 0.000,10.000 C 0.000,15.514 4.485,20.000 10.000,20.000 C 15.514,20.000 20.000,15.514 20.000,10.000 C 20.000,9.972 19.999,9.945 19.999,9.917 L 17.080,9.917 Z" UseLayoutRounding="False" Canvas.Top="1.932" Canvas.Left="1.937">
                                        <Path.Fill>
                                            <LinearGradientBrush MappingMode="Absolute" StartPoint="489.491,230.414" EndPoint="509.491,230.414">
                                                <LinearGradientBrush.GradientStops>
                                                    <GradientStop Offset="0.00" Color="#ffffffff"/>
                                                    <GradientStop Offset="0.73" Color="#ff7f7f7f"/>
                                                </LinearGradientBrush.GradientStops>
                                                <LinearGradientBrush.Transform>
                                                    <MatrixTransform Matrix="1.000,0.000,-0.000,-1.000,-489.491,245.373" />
                                                </LinearGradientBrush.Transform>
                                            </LinearGradientBrush>
                                        </Path.Fill>
                                    </Path>

                                </Canvas>

                            </Canvas>
                            <ControlTemplate.Triggers>
                                <EventTrigger RoutedEvent="FrameworkElement.Loaded">
                                    <BeginStoryboard Storyboard="{StaticResource spinner}"/>
                                </EventTrigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
            </Style>

        </ResourceDictionary>


    </UserControl.Resources>

    <Grid Margin="0,0,-0.6,0">
        <Grid.ColumnDefinitions>
            <ColumnDefinition></ColumnDefinition>
            <ColumnDefinition></ColumnDefinition>
            <ColumnDefinition></ColumnDefinition>
        </Grid.ColumnDefinitions>
        <StackPanel Orientation="Horizontal" Margin="0,0,60.2,0" Grid.ColumnSpan="3">
            <ComboBox Name="RunTypesComboBox"
                      ItemsSource="{Binding RunTypeItems}"
                      SelectedItem="{Binding SelectedRunTypeItem}"
                      Width ="Auto" 
                      VerticalContentAlignment="Center"
                      HorizontalContentAlignment="Left"
                      Style="{StaticResource ResourceKey=SComboBox}" 
                      FontSize="14px" 
                      Margin="2.5,0,2.5,0">               
                <ComboBox.ItemContainerStyle>
                    <Style TargetType="{x:Type ComboBoxItem}">
                        <Setter Property="IsEnabled" Value="{Binding Enabled}"/>                       
                    </Style>
                </ComboBox.ItemContainerStyle>
                <ComboBox.ItemTemplate>
                    <DataTemplate>
                        <Label Content="{Binding Name}" 
                               IsEnabled="{Binding Enabled}" 
                               ToolTip="{Binding ToolTipText}"
                               ToolTipService.ShowOnDisabled="True">
                            <Label.Style>
                                <Style TargetType="Label">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding Enabled}" Value="True">
                                            <Setter Property="Foreground" Value="#bbbbbb"></Setter>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding Enabled}" Value="False">
                                            <Setter Property="Foreground" Value="#444444"></Setter>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Label.Style>
                        </Label>
                    </DataTemplate>
                </ComboBox.ItemTemplate>
            </ComboBox>

            <Button Name="RunButton"
                                Width="100"
                                Content="{x:Static p:Resources.DynamoViewRunButton}"
                                Style="{StaticResource ResourceKey=STextButton}"
                                Click="RunButton_OnClick"
                                Command="{Binding RunExpressionCommand}"
                                CommandParameter="{Binding Path=RunInDebug}"
                                ToolTip="{Binding RunButtonToolTip}"
                                ToolTipService.ShowOnDisabled="True"
                                IsEnabled="{Binding Path=RunButtonEnabled}"
                                Visibility="{Binding RunButtonVisibility}"
                                Focusable="False" Margin="0,0,2.5,0"
                               />

            <TextBox Name="RunPeriodTextBox" 
                    Text="{Binding RunPeriod, Converter={StaticResource RunPeriodConverter}, Mode=TwoWay}"
                     VerticalContentAlignment="Center"
                     Visibility="{Binding RunPeriodInputVisibility}"
                     Width="80" FontSize="14px"
                     Style="{DynamicResource ResourceKey=SDarkTextBox}" 
                     Foreground="#bbbbbb" 
                     KeyDown="UIElement_OnKeyDown" Margin="2.5,0,0,0"/>

            <CheckBox Margin="10" x:FieldModifier="public" 
                      Name="debugCheckBox" 
                      FontSize="11" 
                      VerticalAlignment="Center"
                      IsChecked="{Binding Path=RunInDebug, Mode=TwoWay}" 
                      Focusable="False"
                      Content="Debug" 
                      VerticalContentAlignment="Center"
                      Visibility="{Binding DebugCheckBoxVisibility}">
            </CheckBox>

            <heid:BusyDecorator x:Name="busy"                                 
                                BusyVerticalAlignment="Center"   
                                BusyHorizontalAlignment="Left"
                                BusyStyle="{StaticResource busyStyle}" 
                                IsBusyIndicatorShowing="{Binding ShowBusyIndicator}" 
                                ShowRunText="{Binding ShowRunMessage}"
                                Width="25"/>

        </StackPanel>
        
    </Grid>
</UserControl>
