<!--
    There are two versions of this HTML file. One that is part of the Dynamo Dictionary
    codebase and one that is part of the Dynamo codebase, used for displaying additional
    error information in the Dynamo side panel.

    These files need to kept in sync manually: if making edits to one version of the file,
    make sure to update the other version as well.

    Dynamo: https://github.com/DynamoDS/Dynamo
    Dynamo Dictionary: https://github.com/DynamoDS/DynamoDictionary_React
-->
<!-- These headers are required to force the browser embedded in the DocumentationBrowser extension to render in modern IE11 mode. -->

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width initial-scale=1">
    <meta charset="UTF-8" />
</head>

<style>
    body {
        color: white;
        font-size: 14px;
        font-family: "Artifakt Element";
        src: url("fonts/ArtifaktElement-Regular.woff") format("woff");
        padding: 1%;
    }

    a {
        color: lightgray;
        cursor: pointer;
        background-color: transparent;
    }

    table {
        border-collapse: collapse;
        border: 1px solid white;
    }

    th,
    td {
        border: 1px solid white;
        padding-right: 10px;
        padding-left: 10px;
        padding-bottom: 10px;
        padding-top: 10px;
    }

    samp {
        margin-top: 10px;
        display: block;
        color: lightgrey;
    }

    code .k {
        color: #dcdcaa;
        font-weight: bold;
    }

    code .s {
        color: #ce9178;
    }

    code .v {
        color: #b5cea8;
    }

    code .o {
        color: #c586c0;
        font-weight: bold;
    }

    code .i {
        color: #569cd6;
        font-weight: bold;
    }

    code .b {
        color: #9cdcfe;
        font-weight: bold;
    }

    code .e {
        color: #43c9b0;
    }

    code > .nl .nl {
        padding-left: 10px;
    }

    code .nl {
        display: block;
    }

    thead {
        text-align: center;
    }

    .hidden-lg {
        display: none;
    }

    .button {
        background-color: transparent;
        border-color: #3c3c3c;
        color: #bbbbbb;
    }

    .button:hover {
        border-color: #656565;
        background-color: #373737;
        opacity: 1.0;
    }
    .questionmark:after {
        content: '?';
        display: inline-block;
        font-family: sans-serif;
        font-weight: bold;
        text-align: center;
        font-size: 0.8em;
        line-height: 0.8em;
        border-radius: 50%;
        margin-left: 6px;
        padding: 0.13em 0.2em 0.09em 0.2em;
        color: inherit;
        border: 1px solid;
        text-decoration: none;
    }
    @media screen and (max-width: 600px) {
        table {
            width: 100%;
        }

        table,
        th,
        td {
            border: none;
        }

        tr {
            border: 1px solid white;
            display: block;
        }

        td,
        th {
            display: block;
        }

        .hidden-lg {
            display: block;
            font-weight: bold;
            text-align: center;
            border-bottom: 1px solid white;
        }

        .hidden-sm {
            display: none;
        }

        .spaced-sm {
            margin-top: 20px;
        }

        tbody tr:first-of-type {
            border-bottom: none;
        }
    }
</style>

<!-- Use inline styles to keep Dynamo Dictionary styling in the dictionary -->
<!-- and custom styling in Dynamo sidepanel. -->

<body style="background-color: #353535; font-family: 'Artifakt Element', 'Open Sans';">
    <form action="https://forum.dynamobim.com/t/new-feature-preview-python-3-support-issue-thread/51649">
        <input type="submit" class="button" value="Report Python 3 node issue" style="font-size:medium;" />
    </form>
    <h2>Python 2 to Python 3 conversion</h2>
    <p>
        The Python Software Foundation (PSF) officially ended support for Python 2 on January 1, 2020. Since version 2.7, Dynamo has switched to CPython3, a Python engine that provides access to Python 3 inside of Dynamo.
    </p>
   
    <h3>Why did we change the Python version?</h3>
    <p>
        Dynamo, like many other C#-based environments, uses a tool called IronPython to move data between .NET objects and Python scripts. As IronPython has not been updated to Python 3, Dynamo has transitioned to use CPython, the standard native Python interpreter.
    </p>
    <p>Moving Dynamo to Python 3 allows Dynamo users to access popular modern libraries and continue to access new platform features, essential maintenance, and security patches. In addition, Dynamo graphs can benefit from Python libraries with native extensions that were previously not accessible, such as NumPy, SciPy, and Pandas.</p>

    <h3>Backwards compatibility</h3>
    <p>
        There is no guarantee that any code written in the CPython3 environment will work in previous versions of Dynamo. Code authors should ensure backwards compatibility with both the IronPython2 and CPython3 versions as desired.
    </p>
    
    <h3>What does this mean for you and your Python-containing graphs?</h3>
    <p>
        If you are not the author of the graph or the Python nodes it contains, please contact the author and let them know about these changes so they can make changes where necessary.
    </p>
    <p>
        If you are the graph author, read the guidance below to understand how these changes may affect your Python nodes and how to make updates.
    </p>

    <p>
        Python 3 is fundamentally the same language as Python 2, with changes to syntax and the core library to make Python more consistent and learnable, and to provide improved Unicode support.
    </p>
    <p>
        Some Python 2 programs will run as normal on Python 3, but a lot of common constructs will require small changes, including the print statement. Luckily, many of these can be automated.
    </p>

    <h3>How to update your Python nodes for Python 3 </h3>
    <p>
        Typically, Python scripts can run using either the IronPython2 or CPython3 engines. For any cases where your script contains syntax that has changed between versions, we have made it easier for you to update your script by including an automatic code converter in the Python node called the Migration Assistant.
    </p>
    <p>
        To update your script with the Migration Assistant, open the Python Node editor, switch to the CPython3 engine using the drop-down, and click the 2->3 icon. Dynamo will let you know which changes are needed and give you the option to decline or accept the conversion.
    </p>
    <p>
        As the Python Script From String node simply executes the Python code input into it and does not provide a text editor environment, it does not have access to the Migration Assistant. If you wish to use this feature, you will need to copy and paste your code into a Python node temporarily before copying and pasting it back into your code block node.
    </p>

    <h3>Learn more</h3>
    <p>
        If you are curious about diving deeper into the differences between the two Python versions, here are two
        external links to get you started:
        <ul>
            <li>
                <a href="https://docs.python.org/3/howto/pyporting.html">The official "Porting Python 2 Code to Python 3" guide</a>
            </li>
            <li>
                <a href="http://python3porting.com/">Supporting Python 3: An in-depth guide" guide</a>
            </li>
        </ul>
    </p>

    <h3>Key syntax changes in Python 3</h3>
    <p>
        The list below explains some of the key syntax changes between Python 2 and Python 3. This is selection of some of the most widely used features that have been affected, not an exhaustive list.
    </p>


    <h4><b>Print Function</b></h4>
    <p>
        The print syntax is probably the most widely-known change. Even though it is not often used in Dynamo, here is
        an example showing how the <code>print</code> statement has changed.
    </p>

    <table>
        <tr>
            <th>Python 2</th>
            <th class="hidden-sm">Python 3</th>
        </tr>
        <tr>
            <td>
                <code><span class="k">print</span> <span class="s">'Hello, Dynamo!'</span></code>
                <samp>// Hello, Dynamo!</samp>
            </td>
            <th class="hidden-lg" style="border-top: 1px solid white;">Python 3</th>
            <td>
                <code><span class="k">print</span>(<span class="s">'Hello, Dynamo!'</span>)</code>
                <samp>// Hello, Dynamo!</samp>
            </td>
        </tr>
    </table>

    <h4><b>Integer division</b></h4>
    <p>
        This change will not raise any exceptions in your script, but it might affect the output. When presented with
        integer operands, the default division operator behavior in Python 2.x is to use classic division which
        truncates the decimal place and returns an integer. When given a pair of floating-point operands, it returns the
        actual floating-point quotient (aka true division).
    </p>

    <table>
        <tr>
            <th>Python 2</th>
            <th class="hidden-sm">Python 3</th>
        </tr>
        <tr>
            <td>
                <code><span class="v">1</span>/<span class="v">2</span></code>
                <samp>// 0</samp>
            </td>
            <td class="hidden-lg" style="border-top: 1px solid white;">Python 3</td>
            <td>
                <code><span class="v">1</span>/<span class="v">2</span></code>
                <samp>// 0.5</samp>
            </td>
        </tr>
        <tr class="spaced-sm">
            <td class="hidden-lg">Python 2</td>
            <td>
                <code><span class="v">1.0</span>/<span class="v">2.0</span></code>
                <samp>// 0.5</samp>
            </td>
            <td class="hidden-lg" style="border-top: 1px solid white;">Python 3</td>
            <td>
                <code><span class="v">1.0</span>/<span class="v">2.0</span></code>
                <samp>// 0.5</samp>
            </td>
        </tr>
    </table>

    <h4><b>xrange</b></h4>
    <p>
        <code>xrange</code> is usually used in combination with a for-loop or list-comprehensive statements. When you
        only need to iterate once, it is generally faster to iterate over <code>xrange()</code> compared with
        <code>range()</code>.
        In Python 3, the <code>range()</code> was implemented in the same way as the <code>xrange()</code> function, so
        that a dedicated <code>xrange()</code>
        function no longer exists. Instead, xrange() raises a NameError.
    </p>

    <table>
        <tr>
            <th>Python 2</th>
            <th class="hidden-sm">Python 3</th>
        </tr>
        <tr>
            <td>
                <code>
                    <span class="nl">n = <span class="v">1000000</span></span>
                    <span class="nl">
                        <span class="o">for</span> i <span class="i">in</span> <span class="b">xrange</span>(n):
                        <span class="nl"><span class="k">print</span> i</span>
                    </span>
                </code>
                <samp>// 1,2,3,4,5...</samp>
            </td>
            <th class="hidden-lg" style="border-top: 1px solid white;">Python 3</th>
            <td>
                <code>
                    <span class="nl">n = <span class="v">1000000</span></span>
                    <span class="nl">
                        <span class="o">for</span> i <span class="i">in</span> <span class="k">range</span>(n):
                        <span class="nl"><span class="k">print</span>(i)</span>
                    </span>
                </code>
                <samp>// 1,2,3,4,5...</samp>
            </td>
        </tr>
    </table>

    <h4><b>Raising and handling exceptions</b></h4>
    <p>
        Where Python 2 accepts both notations - the ‘old’ and the ‘new’ syntax - Python 3 raises a SyntaxError if we
        don’t enclose the exception argument in parentheses. The handling of exceptions has also slightly changed in
        Python 3, where we now need to include the “as” keyword.
    </p>

    <table>
        <tr>
            <th>Python 2</th>
            <th class="hidden-sm">Python 3</th>
        </tr>
        <tr>
            <td>
                <code>
                    <span class="o">raise</span> <span class="e">IOError</span>, <span class="s">"file error"</span>
                </code>
                <samp>// IOError: file error</samp>
            </td>
            <td class="hidden-lg" style="border-top: 1px solid white;">Python 3</td>
            <td>
                <code>
                    <span class="o">raise</span> <span class="e">IOError</span>(<span class="s">"file error"</span>)
                </code>
                <samp>// OSError: file error</samp>
            </td>
        </tr>
        <tr class="spaced-sm">
            <td class="hidden-lg">Python 2</td>
            <td>
                <code>
                    <span class="nl">
                        <span class="o">try:</span>
                        <span class="nl">let_us_cause_a_NameError</span>
                    </span>
                    <span class="nl">
                        <span class="o">except</span> <span class="e">NameError</span>, err:
                        <span class="nl"><span class="k">print</span> err, <span class="s">'--> our error message'</span></span>
                    </span>
                </code>
                <samp>// IOError: file error</samp>
            </td>
            <td class="hidden-lg" style="border-top: 1px solid white;">Python 3</td>
            <td>
                <code>
                    <span class="nl">
                        <span class="o">try:</span>
                        <span class="nl">let_us_cause_a_NameError</span>
                    </span>
                    <span class="nl">
                        <span class="o">except</span> <span class="e">NameError</span> <span class="o">as</span> err:
                        <span class="nl"><span class="k">print</span>(err, <span class="s">'--> our error message'</span>)</span>
                    </span>
                </code>
                <samp>// OSError: file error</samp>
            </td>
        </tr>
    </table>
</body>
