<!--
    There are two versions of this HTML file. One that is part of the Dynamo Dictionary
    codebase and one that is part of the Dynamo codebase, used for displaying additional
    error information in the Dynamo side panel.

    These files need to kept in sync manually: if making edits to one version of the file,
    make sure to update the other version as well.

    Dynamo: https://github.com/DynamoDS/Dynamo
    Dynamo Dictionary: https://github.com/DynamoDS/DynamoDictionary_React
-->
<!-- These headers are required to force the browser embedded in the DocumentationBrowser extension to render in modern IE11 mode. -->

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width initial-scale=1">
    <meta charset="utf-8" />
</head>

<style>body { color: white; font-size: 14px; font-family: "Artifakt Element"; src: url("fonts/ArtifaktElement-Regular.woff") format("woff"); padding: 1%; } a { color: lightgray; cursor: pointer; background-color: transparent; } table { border-collapse: collapse; border: 1px solid white; } th, td { border: 1px solid white; padding-right: 10px; padding-left: 10px; padding-bottom: 10px; padding-top: 10px; } samp { margin-top: 10px; display: block; color: lightgrey; } code .k { color: #dcdcaa; font-weight: bold; } code .s { color: #ce9178; } code .v { color: #b5cea8; } code .o { color: #c586c0; font-weight: bold; } code .i { color: #569cd6; font-weight: bold; } code .b { color: #9cdcfe; font-weight: bold; } code .e { color: #43c9b0; } code  .nl .nl { padding-left: 10px; } code .nl { display: block; } thead { text-align: center; } .hidden-lg { display: none; } .button { background-color: transparent; border-color: #3c3c3c; color: #bbbbbb; } .button:hover { border-color: #656565; background-color: #373737; opacity: 1.0; } .questionmark:after { content: '?'; display: inline-block; font-family: sans-serif; font-weight: bold; text-align: center; font-size: 0.8em; line-height: 0.8em; border-radius: 50%; margin-left: 6px; padding: 0.13em 0.2em 0.09em 0.2em; color: inherit; border: 1px solid; text-decoration: none; } @media screen and (max-width: 600px) { table { width: 100%; } table, th, td { border: none; } tr { border: 1px solid white; display: block; } td, th { display: block; } .hidden-lg { display: block; font-weight: bold; text-align: center; border-bottom: 1px solid white; } .hidden-sm { display: none; } .spaced-sm { margin-top: 20px; } tbody tr:first-of-type { border-bottom: none; } }</style>

<!-- Use inline styles to keep Dynamo Dictionary styling in the dictionary -->
<!-- and custom styling in Dynamo sidepanel. -->

<body style="background-color: #353535; font-family: 'Artifakt Element', 'Open Sans';">
    <form action="https://forum.dynamobim.com/t/new-feature-preview-python-3-support-issue-thread/51649"><input type="submit" class="button" value="回報 Python 3 節點問題" style="font-size:medium;"/></form>
    <h2>將 Python 2 轉換為 Python 3</h2>
    <p>Python Software Foundation (PSF) 已在 2020 年 1 月 1 日正式終止對 Python 2 的支援。自 2.7 版起，Dynamo 已換成 CPython3，這是一款可讓您存取 Dynamo 內 Python 3 的 Python 引擎。</p>
   
    <h3>為什麼要變更 Python 版本？</h3>
    <p>Dynamo 與其他許多 C# 環境一樣，使用一種稱為 IronPython 的工具，在 .NET 物件與 Python 指令碼之間移動資料。由於 IronPython 尚未更新到 Python 3，因此 Dynamo 轉換為使用標準原生的 Python 解譯器 CPython。</p>
    <p>將 Dynamo 轉換到 Python 3 可讓 Dynamo 使用者存取常用的現代資源庫，並繼續存取新的平台功能、基本維護和安全性修補。此外，Dynamo 圖表也能獲得 Python 資源庫的好處，使用先前無法存取的原生延伸，例如 NumPy、SciPy 和 Pandas。</p>

    <h3>向下相容性</h3>
    <p>但是並不保證在 CPython3 環境中撰寫的所有程式碼都能在舊版 Dynamo 中運作。程式碼作者應確保與 IronPython2 和 CPython3 版本的向下相容性。</p>
    
    <h3>這對您和您包含 Python 的圖表代表什麼意義？</h3>
    <p>如果您不是圖表或其包含的 Python 節點的作者，請聯絡作者並告知他們這些改變，以便他們可以在需要時進行變更。</p>
    <p>如果您是圖表作者，請閱讀下面的指導，以瞭解這些改變如何影響您的 Python 節點，以及如何進行更新。</p>

    <p>Python 3 與 Python 2 基本上是相同的語言，其語法和核心資源庫的改變可讓 Python 更一致易學，並提供改進的 Unicode 支援。</p>
    <p>某些 Python 2 程式在 Python 3 會正常執行，但有大量的通用建構需要進行少許變更，包括 print 陳述式。幸好這許多作業都可以自動執行。</p>

    <h3>如何更新您的 Python 節點適用於 Python 3 </h3>
    <p>Python 指令碼通常可以使用 IronPython2 或 CPython3 引擎執行。如果您的指令碼包含版本間不同的語法，我們已在名為「移轉助理」的 Python 節點中放入自動程式碼轉換器，讓您更輕鬆地更新指令碼。</p>
    <p>若要使用「移轉助理」更新您的指令碼，請開啟 Python 節點編輯器，使用下拉式清單切換到 CPython3 引擎，然後按一下 2-3 圖示。Dynamo 會告訴您需要進行哪些變更，並讓您選擇拒絕或接受轉換。</p>
    <p>由於 Python Script From String 節點只會執行輸入到當中的 Python 程式碼，且不提供文字編輯器環境，因此它無法存取「移轉助理」。如果您想要使用此功能，必須暫時先將您的程式碼複製並貼到某個 Python 節點中，再複製並貼回您的 Code Block 節點。</p>

    <h3>進一步瞭解</h3>
    <p>如果您想要更深入地瞭解兩個 Python 版本之間的差異，可以使用下面兩個外部連結開始:<ul>
            <li><a href="https://docs.python.org/3/howto/pyporting.html">Porting Python 2 Code to Python 3 官方指南</a></li>
            <li><a href="http://python3porting.com/">Supporting Python 3: An in-depth guide 指南</a></li>
        </ul>
    </p>

    <h3>Python 3 的關鍵語法變更</h3>
    <p>以下清單說明 Python 2 與 Python 3 之間某些關鍵語法的改變。這些只是一部分最廣泛使用且受影響的功能，並非詳盡的清單。</p>


    <h4><b>列印功能</b></h4>
    <p>列印語法是最廣為人知的變更。即使 Dynamo 中不常用，但是下面這個範例顯示 <code>print</code> 陳述式的變更。</p>

    <table>
        <tr>
            <th>Python 2</th>
            <th class="hidden-sm">Python 3</th>
        </tr>
        <tr>
            <td><code><span class="k">print</span> <span class="s">'Hello, Dynamo!'</span></code> <samp>// Hello, Dynamo!</samp></td>
            <th class="hidden-lg" style="border-top: 1px solid white;">Python 3</th>
            <td><code><span class="k">print</span>(<span class="s">'Hello, Dynamo!'</span>)</code> <samp>// Hello, Dynamo!</samp></td>
        </tr>
    </table>

    <h4><b>整數除法</b></h4>
    <p>此變更不會在指令碼中產生任何例外狀況，但是可能會影響輸出。顯示整數運算元時，Python 2.x 中的預設除法運算子行為是使用傳統除法，它會截斷小數位數並傳回整數。如果給定一對浮點運算元，它會傳回實際的浮點商數 (也稱為真除法)。</p>

    <table>
        <tr>
            <th>Python 2</th>
            <th class="hidden-sm">Python 3</th>
        </tr>
        <tr>
            <td><code><span class="v">1</span>/<span class="v">2</span></code> <samp>// 0</samp></td>
            <td class="hidden-lg" style="border-top: 1px solid white;">Python 3</td>
            <td><code><span class="v">1</span>/<span class="v">2</span></code> <samp>// 0.5</samp></td>
        </tr>
        <tr class="spaced-sm">
            <td class="hidden-lg">Python 2</td>
            <td><code><span class="v">1.0</span>/<span class="v">2.0</span></code> <samp>// 0.5</samp></td>
            <td class="hidden-lg" style="border-top: 1px solid white;">Python 3</td>
            <td><code><span class="v">1.0</span>/<span class="v">2.0</span></code> <samp>// 0.5</samp></td>
        </tr>
    </table>

    <h4><b>xrange</b></h4>
    <p><code>xrange</code> 通常會結合 for 迴圈或列表理解的陳述式使用。 如果您只需要迭代一次，與 <code>range()</code> 相比，透過 <code>xrange()</code> 迭代通常會更快速。在 Python 3 中，<code>range()</code> 的實施方式與 <code>xrange()</code> 函數相同，因此已經沒有專用的 <code>xrange()</code> 函數。使用 xrange() 反而會產生 NameError。</p>

    <table>
        <tr>
            <th>Python 2</th>
            <th class="hidden-sm">Python 3</th>
        </tr>
        <tr>
            <td><code> <span class="nl">n = <span class="v">1000000</span></span> <span class="nl"> <span class="o">for</span> i <span class="i">in</span> <span class="b">xrange</span>(n): <span class="nl"><span class="k">print</span> i</span> </span> </code> <samp>// 1,2,3,4,5...</samp></td>
            <th class="hidden-lg" style="border-top: 1px solid white;">Python 3</th>
            <td><code> <span class="nl">n = <span class="v">1000000</span></span> <span class="nl"> <span class="o">for</span> i <span class="i">in</span> <span class="k">range</span>(n): <span class="nl"><span class="k">print</span>(i)</span> </span> </code> <samp>// 1,2,3,4,5...</samp></td>
        </tr>
    </table>

    <h4><b>產生和處理例外</b></h4>
    <p>Python 2 在許多情況下接受「舊」語法和「新」語法兩種表示法，但是在 Python 3 必須用括弧括住例外引數，否則會產生 SyntaxError。 Python 3 對例外的處理也稍有變更，我們現在需要包含「as」關鍵字。</p>

    <table>
        <tr>
            <th>Python 2</th>
            <th class="hidden-sm">Python 3</th>
        </tr>
        <tr>
            <td><code> <span class="o">raise</span> <span class="e">IOError</span>, <span class="s">&quot;file error&quot;</span> </code> <samp>// IOError: file error</samp></td>
            <td class="hidden-lg" style="border-top: 1px solid white;">Python 3</td>
            <td><code> <span class="o">raise</span> <span class="e">IOError</span>(<span class="s">&quot;file error&quot;</span>) </code> <samp>// OSError: file error</samp></td>
        </tr>
        <tr class="spaced-sm">
            <td class="hidden-lg">Python 2</td>
            <td><code> <span class="nl"> <span class="o">try:</span> <span class="nl">let_us_cause_a_NameError</span> </span> <span class="nl"> <span class="o">except</span> <span class="e">NameError</span>, err: <span class="nl"><span class="k">print</span> err, <span class="s">'-- our error message'</span></span> </span> </code> <samp>// IOError: file error</samp></td>
            <td class="hidden-lg" style="border-top: 1px solid white;">Python 3</td>
            <td><code> <span class="nl"> <span class="o">try:</span> <span class="nl">let_us_cause_a_NameError</span> </span> <span class="nl"> <span class="o">except</span> <span class="e">NameError</span> <span class="o">as</span> err: <span class="nl"><span class="k">print</span>(err, <span class="s">'-- our error message'</span>)</span> </span> </code> <samp>// OSError: file error</samp></td>
        </tr>
    </table>
</body>
