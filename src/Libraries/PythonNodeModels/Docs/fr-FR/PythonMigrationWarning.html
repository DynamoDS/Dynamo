<!--
    There are two versions of this HTML file. One that is part of the Dynamo Dictionary
    codebase and one that is part of the Dynamo codebase, used for displaying additional
    error information in the Dynamo side panel.

    These files need to kept in sync manually: if making edits to one version of the file,
    make sure to update the other version as well.

    Dynamo: https://github.com/DynamoDS/Dynamo
    Dynamo Dictionary: https://github.com/DynamoDS/DynamoDictionary_React
-->
<!-- These headers are required to force the browser embedded in the DocumentationBrowser extension to render in modern IE11 mode. -->

<head>
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width initial-scale=1">
    <meta charset="utf-8" />
</head>

<style>body { color: white; font-size: 14px; font-family: "Artifakt Element"; src: url("fonts/ArtifaktElement-Regular.woff") format("woff"); padding: 1%; } a { color: lightgray; cursor: pointer; background-color: transparent; } table { border-collapse: collapse; border: 1px solid white; } th, td { border: 1px solid white; padding-right: 10px; padding-left: 10px; padding-bottom: 10px; padding-top: 10px; } samp { margin-top: 10px; display: block; color: lightgrey; } code .k { color: #dcdcaa; font-weight: bold; } code .s { color: #ce9178; } code .v { color: #b5cea8; } code .o { color: #c586c0; font-weight: bold; } code .i { color: #569cd6; font-weight: bold; } code .b { color: #9cdcfe; font-weight: bold; } code .e { color: #43c9b0; } code  .nl .nl { padding-left: 10px; } code .nl { display: block; } thead { text-align: center; } .hidden-lg { display: none; } .button { background-color: transparent; border-color: #3c3c3c; color: #bbbbbb; } .button:hover { border-color: #656565; background-color: #373737; opacity: 1.0; } .questionmark:after { content: '?'; display: inline-block; font-family: sans-serif; font-weight: bold; text-align: center; font-size: 0.8em; line-height: 0.8em; border-radius: 50%; margin-left: 6px; padding: 0.13em 0.2em 0.09em 0.2em; color: inherit; border: 1px solid; text-decoration: none; } @media screen and (max-width: 600px) { table { width: 100%; } table, th, td { border: none; } tr { border: 1px solid white; display: block; } td, th { display: block; } .hidden-lg { display: block; font-weight: bold; text-align: center; border-bottom: 1px solid white; } .hidden-sm { display: none; } .spaced-sm { margin-top: 20px; } tbody tr:first-of-type { border-bottom: none; } }</style>

<!-- Use inline styles to keep Dynamo Dictionary styling in the dictionary -->
<!-- and custom styling in Dynamo sidepanel. -->

<body style="background-color: #353535; font-family: 'Artifakt Element', 'Open Sans';">
    <form action="https://forum.dynamobim.com/t/new-feature-preview-python-3-support-issue-thread/51649"><input type="submit" class="button" value="Signaler un problème de noeud Python 3" style="font-size:medium;"/></form>
    <h2>Conversion de Python 2 en Python 3</h2>
    <p>La Python Software Foundation (PSF) a officiellement cessé de prendre en charge Python 2 le 1er janvier 2020.À compter de la version 2.7, Dynamo est passé à CPython3, un moteur Python permettant d'accéder à Python 3 dans Dynamo.</p>
   
    <h3>Pourquoi avons-nous modifié la version de Python ?</h3>
    <p>Comme de nombreux autres environnements basés sur C#, Dynamo utilise un outil appelé IronPython pour déplacer des données entre les objets .NET et les scripts Python.IronPython n'ayant pas été mis à jour vers Python 3, Dynamo a effectué une migration pour utiliser CPython, l'interpréteur Python natif standard.</p>
    <p>La mise à niveau de Dynamo vers Python 3 permet aux utilisateurs de Dynamo d'accéder aux bibliothèques modernes les plus populaires et de continuer à accéder aux nouvelles fonctionnalités de la plate-forme, aux tâches de maintenance essentielles et aux correctifs de sécurité.En outre, les graphiques Dynamo peuvent bénéficier des bibliothèques Python avec des extensions natives qui n'étaient auparavant pas accessibles, telles que NumPy, SciPy et Pandas.</p>

    <h3>Compatibilité avec les versions antérieures</h3>
    <p>Il n'existe aucune garantie qu'un code écrit dans l'environnement CPython3 fonctionnera dans les versions antérieures de Dynamo. Les auteurs de code doivent garantir la compatibilité des versions antérieures avec les versions IronPython2 et CPython3 comme souhaité.</p>
    
    <h3>Qu'est-ce que cela signifie pour vous et vos graphiques qui contiennent du Python?</h3>
    <p>Si vous n'êtes pas l'auteur du graphique ou des noeuds Python qu'il contient, contactez l'auteur et informez-le de ces modifications afin qu'il puisse les mettre en oeuvre là où cela est nécessaire.</p>
    <p>Si vous êtes l'auteur du graphique, lisez les instructions ci-dessous pour comprendre comment ces modifications peuvent affecter vos noeuds Python et comment effectuer des mises à jour.</p>

    <p>Python 3 est essentiellement le même langage que Python 2, avec des modifications apportées à la syntaxe et à la bibliothèque principale pour rendre le langage Python plus cohérent et plus facile à apprendre, ainsi que pour fournir une meilleure prise en charge d'Unicode.</p>
    <p>Certains programmes Python 2 fonctionneront normalement sur Python 3, mais beaucoup de structures courantes nécessiteront de petites modifications, notamment l'instruction d'impression. Heureusement, nombre de ces modifications peuvent être automatisées.</p>

    <h3>Comment mettre à jour vos noeuds Python pour Python 3</h3>
    <p>En règle générale, les scripts Python peuvent être exécutés à l'aide des moteurs IronPython2 ou CPython3. Pour les cas où votre script contient une syntaxe différente d'une version à l'autre, nous avons facilité la mise à jour de votre script en incluant un convertisseur de code automatique dans le noeud Python appelé Migration Assistant.</p>
    <p>Pour mettre à jour votre script à l'aide de Migration Assistant, ouvrez l'éditeur de noeuds Python, passez au moteur CPython3 à l'aide de la liste déroulante, puis cliquez sur l'icône 2-3.Dynamo vous indique les modifications nécessaires et vous donne la possibilité de refuser ou d'accepter la conversion.</p>
    <p>Étant donné que le noeud Python Script From String exécute simplement l'entrée de code Python dans celui-ci et ne fournit pas d'environnement d'éditeur de texte, il n'a pas accès au Migration Assistant.Si vous souhaitez utiliser cette fonctionnalité, vous devrez copier-coller temporairement votre code dans un noeud Python avant de le copier et de le coller à nouveau dans votre noeud Code Block.</p>

    <h3>En savoir plus</h3>
    <p>Si vous souhaitez approfondir les différences entre les deux versions de Python, voici deux liens externes pour vous aider à commencer:<ul>
            <li><a href="https://docs.python.org/3/howto/pyporting.html">Guide officiel relatif au portage de code Python 2 vers Python 3</a></li>
            <li><a href="http://python3porting.com/">&quot;Supporting Python 3: An in-depth guide&quot; (Guide approfondi pour la prise en charge de Python 3)</a></li>
        </ul>
    </p>

    <h3>Modifications clés en matière de syntaxe dans Python 3</h3>
    <p>La liste ci-dessous décrit certaines des principales modifications de syntaxe entre Python 2 et Python 3.Il s'agit d'une sélection de certaines des fonctionnalités les plus fréquemment utilisées ayant été affectées, et non d'une liste exhaustive.</p>


    <h4><b>Fonction d'impression</b></h4>
    <p>La syntaxe d'impression est probablement la modification la plus connue. Bien qu'elle ne soit pas souvent utilisée dans Dynamo, voici un exemple montrant comment l'instruction <code>print</code> a changé.</p>

    <table>
        <tr>
            <th>Python 2</th>
            <th class="hidden-sm">Python 3</th>
        </tr>
        <tr>
            <td><code><span class="k">print</span> <span class="s">'Hello, Dynamo!'</span></code> <samp>// Hello, Dynamo!</samp></td>
            <th class="hidden-lg" style="border-top: 1px solid white;">Python 3</th>
            <td><code><span class="k">print</span>(<span class="s">'Hello, Dynamo!'</span>)</code> <samp>// Hello, Dynamo!</samp></td>
        </tr>
    </table>

    <h4><b>Division de nombre entier</b></h4>
    <p>Cette modification ne générera aucune exception dans votre script, mais elle peut avoir une incidence sur le résultat. Lorsqu'on lui soumet des opérandes avec des nombres entiers, le comportement par défaut de l'opérateur de division dans Python 2.X consiste à utiliser une division classique qui tronque les décimales et renvoie un nombre entier. Lorsqu'elle est définie sur une paire d'opérandes à virgule flottante, elle renvoie le quotient à virgule flottante réel (également appelé division réelle).</p>

    <table>
        <tr>
            <th>Python 2</th>
            <th class="hidden-sm">Python 3</th>
        </tr>
        <tr>
            <td><code><span class="v">1</span>/<span class="v">2</span></code> <samp>// 0</samp></td>
            <td class="hidden-lg" style="border-top: 1px solid white;">Python 3</td>
            <td><code><span class="v">1</span>/<span class="v">2</span></code> <samp>// 0.5</samp></td>
        </tr>
        <tr class="spaced-sm">
            <td class="hidden-lg">Python 2</td>
            <td><code><span class="v">1.0</span>/<span class="v">2.0</span></code> <samp>// 0.5</samp></td>
            <td class="hidden-lg" style="border-top: 1px solid white;">Python 3</td>
            <td><code><span class="v">1.0</span>/<span class="v">2.0</span></code> <samp>// 0.5</samp></td>
        </tr>
    </table>

    <h4><b>xrange</b></h4>
    <p><code>xrange</code> est généralement utilisé avec une boucle FOR ou des instructions de liste en compréhension. Lorsque vous n'avez besoin d'effectuer qu'une seule itération, il est généralement plus rapide de procéder à des itérations avec <code>xrange()</code> plutôt qu'avec <code>range()</code>. Dans Python 3, <code>range()</code> a été implémenté de la même façon que la fonction <code>xrange()</code>, de sorte qu'une fonction <code>xrange()</code> dédiée n'existe plus. Au lieu de cela, xrange() génère une erreur NameError.</p>

    <table>
        <tr>
            <th>Python 2</th>
            <th class="hidden-sm">Python 3</th>
        </tr>
        <tr>
            <td><code> <span class="nl">n = <span class="v">1000000</span></span> <span class="nl"> <span class="o">for</span> i <span class="i">in</span> <span class="b">xrange</span>(n): <span class="nl"><span class="k">print</span> i</span> </span> </code> <samp>// 1,2,3,4,5...</samp></td>
            <th class="hidden-lg" style="border-top: 1px solid white;">Python 3</th>
            <td><code> <span class="nl">n = <span class="v">1000000</span></span> <span class="nl"> <span class="o">for</span> i <span class="i">in</span> <span class="k">range</span>(n): <span class="nl"><span class="k">print</span>(i)</span> </span> </code> <samp>// 1,2,3,4,5...</samp></td>
        </tr>
    </table>

    <h4><b>Création et gestion d'exceptions</b></h4>
    <p>Alors que Python 2 accepte les deux notations, c'est-à-dire l'ancienne et la nouvelle syntaxe, Python 3 génère une erreur SyntaxError si l'argument d'exception n'est pas placé entre parenthèses. La gestion des exceptions a également légèrement changé dans Python 3, où il faut maintenant inclure le mot-clé &quot;as&quot;.</p>

    <table>
        <tr>
            <th>Python 2</th>
            <th class="hidden-sm">Python 3</th>
        </tr>
        <tr>
            <td><code> <span class="o">raise</span> <span class="e">IOError</span>, <span class="s">&quot;file error&quot;</span> </code> <samp>// IOError: file error</samp></td>
            <td class="hidden-lg" style="border-top: 1px solid white;">Python 3</td>
            <td><code> <span class="o">raise</span> <span class="e">IOError</span>(<span class="s">&quot;file error&quot;</span>) </code> <samp>// OSError: file error</samp></td>
        </tr>
        <tr class="spaced-sm">
            <td class="hidden-lg">Python 2</td>
            <td><code> <span class="nl"> <span class="o">try:</span> <span class="nl">let_us_cause_a_NameError</span> </span> <span class="nl"> <span class="o">except</span> <span class="e">NameError</span>, err: <span class="nl"><span class="k">print</span> err, <span class="s">'-- our error message'</span></span> </span> </code> <samp>// IOError: file error</samp></td>
            <td class="hidden-lg" style="border-top: 1px solid white;">Python 3</td>
            <td><code> <span class="nl"> <span class="o">try:</span> <span class="nl">let_us_cause_a_NameError</span> </span> <span class="nl"> <span class="o">except</span> <span class="e">NameError</span> <span class="o">as</span> err: <span class="nl"><span class="k">print</span>(err, <span class="s">'-- our error message'</span>)</span> </span> </code> <samp>// OSError: file error</samp></td>
        </tr>
    </table>
</body>
